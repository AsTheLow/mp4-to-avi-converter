# Définir le chemin du dossier contenant les fichiers MP4 à convertir
$sourceFolder = "C:\Chemin\vers\le\dossier\source"

# Définir le chemin du dossier de destination pour les fichiers AVI convertis
$destinationFolder = "C:\Chemin\vers\le\dossier\destination"

# Assurez-vous que le dossier de destination existe, sinon, créez-le
if (-not (Test-Path -Path $destinationFolder)) {
    New-Item -Path $destinationFolder -ItemType Directory
}

# Récupérer la liste des fichiers MP4 dans le dossier source
$mp4Files = Get-ChildItem -Path $sourceFolder -Filter *.mp4

# Parcourir les fichiers MP4 et les convertir en AVI en utilisant FFmpeg
foreach ($mp4File in $mp4Files) {
    $aviFileName = [System.IO.Path]::ChangeExtension($mp4File.Name, ".avi")
    $aviFilePath = Join-Path -Path $destinationFolder -ChildPath $aviFileName

    # Utiliser FFmpeg pour effectuer la conversion
    Start-Process -NoNewWindow -FilePath "ffmpeg" -ArgumentList "-i `"$($mp4File.FullName)`" `"$aviFilePath`"" -Wait -PassThru

    Write-Host "Conversion terminée: $($mp4File.Name) -> $aviFileName"
}

Write-Host "Toutes les conversions sont terminées."
